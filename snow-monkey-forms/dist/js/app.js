(()=>{"use strict";const e=function(e,t){var r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];try{r=new CustomEvent(t,{bubbles:o,cancelable:n,detail:s})}catch(e){(r=document.createEvent("CustomEvent")).initCustomEvent(t,o,n,s)}e.dispatchEvent(r)};async function t(t,r){const s=t.querySelector(".smf-focus-point"),o=t.querySelector(".smf-form"),n=t.querySelector(".smf-action"),a=new FormData(t),c=n.querySelector('[data-clicked="true"]'),l=c||n.querySelector('[type="submit"]'),i=l?l.querySelector(".smf-sending"):void 0;i&&i.setAttribute("aria-hidden","false"),c&&c.removeAttribute("data-clicked");const m={status:"init",inputs:[].slice.call(t.querySelectorAll("input[name]:not([disabled]), textarea[name]:not([disabled]), select[name]:not([disabled])")).map((e=>{let t;return"checkbox"===e.type||"radio"===e.type?e.checked&&(t=e.value):t=e.value,void 0!==t&&{name:e.getAttribute("name"),value:t}})).filter((e=>e)),formData:a},f=e=>{o.innerHTML=e},d=e=>{n.innerHTML=e},u=()=>{s&&window.scrollTo(0,window.pageYOffset+s.getBoundingClientRect().top)},y=(r=null)=>{t.setAttribute("data-screen","systemerror");const s=document.createElement("div");s.classList.add("smf-system-error-content");const o=t.querySelector(".smf-system-error-content-ready");if(s.textContent=o.textContent,r){const e=document.createElement("br"),t=document.createElement("span");t.classList.add("smf-system-error-status-text"),t.textContent=`(status: ${r})`,s.appendChild(e),s.appendChild(t)}f(s.outerHTML),d(""),u(),m.status="systemerror",e(t,"smf.systemerror",m)};e(t,"smf.beforesubmit",m);try{const s=await fetch(snowmonkeyforms.view_json_url,r);if(!s.ok)throw new Error(s.statusText);{const r=await s.json();(r=>{i&&i.setAttribute("aria-hidden","true");const s=r?.method;if(!s)return void y();t.setAttribute("data-screen",s);const o=t.querySelector(".smf-progress-tracker");if(o&&([].slice.call(o.querySelectorAll(".smf-progress-tracker__item")).forEach((e=>{e.setAttribute("aria-current","false"),e.querySelector(".smf-progress-tracker__item__text [aria-hidden]").setAttribute("aria-hidden","true")})),("confirm"===s||"complete"===s?o.querySelector(`.smf-progress-tracker__item--${s}`):o.querySelector(".smf-progress-tracker__item--input")).setAttribute("aria-current","true")),d(r.action),"input"!==s){if([].slice.call(t.querySelectorAll(".smf-placeholder")).forEach((e=>{e.innerHTML=""})),(e=>"back"===e||"invalid"===e||"confirm"===e)(s)){(e=>{for(const r in e){const s=e[r];Array.isArray(s)?t.querySelectorAll(`.smf-placeholder[data-name="${r}"]`).forEach(((e,t)=>{e.innerHTML=s[t]})):t.querySelector(`.smf-placeholder[data-name="${r}"]`).innerHTML=s}})(r.controls);const e=[].slice.call(t.querySelectorAll(".smf-error-messages"));0<e.length?(e=>{if(0<e.length){const t=((e,t)=>{for(let r=e;r;r=r.parentElement)if(r.classList.contains(t))return r})(e[0],"smf-placeholder"),r=!!t&&t.querySelector("input, select, textarea, button, .smf-file-control");r&&r.focus()}})(e):u()}else(e=>"complete"===e||"systemerror"===e)(s)?(f(r.message),u(),d(r.action)):(f(""),d(""));switch(m.status=s,m.status){case"back":e(t,"smf.back",m);break;case"confirm":e(t,"smf.confirm",m);break;case"complete":e(t,"smf.complete",m);break;case"invalid":e(t,"smf.invalid",m);break;case"systemerror":e(t,"smf.systemerror",m)}e(t,"smf.submit",m)}})(JSON.parse(r))}}catch(e){y(e)}}document.addEventListener("change",(e=>{const t=e.target;if(t.classList.contains("smf-file-control__control")){const e=t.closest(".smf-file-control"),r=e.querySelector(".smf-file-control__filename--has-file"),s=t.files;if(0<s.length&&r){const t=s[0];void 0!==t.name&&(r.textContent=t.name,e.classList.add("smf-file-control--set"))}}}),!1),document.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("smf-file-control__clear")){const e=t.closest(".smf-file-control");e.classList.remove("smf-file-control--set"),e.classList.remove("smf-file-control--uploaded"),e.querySelector(".smf-file-control__control").value="";const r=t.closest(".smf-placeholder").querySelector(".smf-file-control__value");r&&r.remove()}}),!1);const r=(e,t)=>{for(let r=e;r;r=r.parentElement)if(r.classList.contains(t))return r};document.addEventListener("click",(e=>{const t=e.target;if(t.getAttribute("data-action")&&t.setAttribute("data-clicked","true"),"back"===t.getAttribute("data-action")){const e=r(t,"smf-action");if(e){const t=e.querySelector('[type="hidden"][name="snow-monkey-forms-meta[method]"]');t&&t.setAttribute("value","back")}}}),!1),[].slice.call(document.querySelectorAll(".snow-monkey-form")).forEach((e=>{e.addEventListener("submit",(r=>{r.preventDefault(),function(e){t(e,{method:"POST",body:new FormData(e),headers:{"X-WP-Nonce":snowmonkeyforms?.nonce}})}(e)})),function(e){var r;t(e,{method:"GET",headers:{"x-smf-formid":null!==(r=e.querySelector('[name="snow-monkey-forms-meta[formid]"]')?.value)&&void 0!==r&&r}})}(e)})),["change","keyup"].forEach((e=>{document.addEventListener(e,(e=>{const t=e.target;if("1"===t.getAttribute("data-invalid")){t.removeAttribute("data-invalid"),[].slice.call(t.querySelectorAll('[data-invalid="1"]')).forEach((e=>e.removeAttribute("data-invalid")));const e=r(t,"smf-placeholder");if(e){const t=e.querySelector(".smf-error-messages");t&&t.parentNode.removeChild(t)}}}),!1)}))})();